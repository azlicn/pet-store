<div class="user-list-container">
    <h1>Users</h1>
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon class="title-icon">people</mat-icon>
        User Management
      </mat-card-title>
      <mat-card-subtitle>Manage system users</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div *ngIf="loading" class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading users...</p>
      </div>

      <div *ngIf="!loading && users.length > 0" class="table-container">
        <table mat-table [dataSource]="users" class="user-table">
          
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef>ID</th>
            <td mat-cell *matCellDef="let user">{{user.id}}</td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let user">
              <div class="user-name">
                <strong>{{user.firstName}} {{user.lastName}}</strong>
                <span *ngIf="isCurrentUser(user.id)" class="current-user-badge">(You)</span>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef>Email</th>
            <td mat-cell *matCellDef="let user"><span>{{user.email}}</span></td>
          </ng-container>

          <ng-container matColumnDef="roles">
            <th mat-header-cell *matHeaderCellDef>Roles</th>
            <td mat-cell *matCellDef="let user">
              <div class="roles-container">
                <mat-chip-set>
                  <mat-chip *ngFor="let role of user.roles" 
                           [color]="getRoleColor(role)"
                           selected>
                    {{role}}
                  </mat-chip>
                </mat-chip-set>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef>Created</th>
            <td mat-cell *matCellDef="let user"><span>{{formatDate(user.createdAt)}}</span></td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Actions</th>
            <td mat-cell *matCellDef="let user">
              <div class="action-buttons">
                <button mat-icon-button 
                        color="warn"
                        (click)="onDeleteUser(user)"
                        [disabled]="isCurrentUser(user.id)"
                        [matTooltip]="isCurrentUser(user.id) ? 'Cannot delete your own account' : 'Delete User'">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>

      <div *ngIf="!loading && users.length === 0" class="empty-state">
        <mat-icon class="large-icon">people_outline</mat-icon>
        <h3>No Users Found</h3>
        <p>There are no users in the system.</p>
      </div>
    </mat-card-content>

    <mat-card-actions align="end">
      
    </mat-card-actions>
  </mat-card>
</div>