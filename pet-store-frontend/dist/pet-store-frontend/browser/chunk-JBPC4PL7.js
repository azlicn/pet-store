import{h}from"./chunk-NWH3GCAN.js";import{b as u}from"./chunk-ORF7SHNW.js";import{W as i,Z as o,ca as n,k as s}from"./chunk-4EBM5WXH.js";var g=(()=>{class r extends h{constructor(e){super(e),this.authUrl=this.getApiUrl("auth"),this.TOKEN_KEY="auth-token",this.USER_KEY="auth-user",this.currentUserSubject=new s(this.getCurrentUser()),this.currentUser$=this.currentUserSubject.asObservable()}login(e){return this.http.post(`${this.authUrl}/login`,e).pipe(i(t=>{this.saveToken(t.token),this.saveUser(t.user),this.currentUserSubject.next(t.user)}))}register(e){return this.http.post(`${this.authUrl}/register`,e)}logout(){this.removeToken(),this.removeUser(),this.currentUserSubject.next(null)}isLoggedIn(){return!!this.getToken()}getCurrentUser(){let e=sessionStorage.getItem(this.USER_KEY);return e?JSON.parse(e):null}getToken(){return sessionStorage.getItem(this.TOKEN_KEY)}hasRole(e){let t=this.getCurrentUser();return t?t.roles.includes(e):!1}isAdmin(){return this.hasRole("ADMIN")}isUser(){return this.hasRole("USER")}updateCurrentUser(e){this.saveUser(e),this.currentUserSubject.next(e)}saveToken(e){sessionStorage.setItem(this.TOKEN_KEY,e)}saveUser(e){sessionStorage.setItem(this.USER_KEY,JSON.stringify(e))}removeToken(){sessionStorage.removeItem(this.TOKEN_KEY)}removeUser(){sessionStorage.removeItem(this.USER_KEY)}static{this.\u0275fac=function(t){return new(t||r)(n(u))}}static{this.\u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{g as a};
